<h1><%=title%></h1>
<br/><a href="/logout">logout</a><br/>

<div id="errorMsg"></div>
<table>
<tr><td>Username</td><td colspan="2">Actions</td></tr>
<% for(var i=0; i<accounts.length; i++) {%>
	<tr id="row<%=accounts[i].id%>">
		<td><%= accounts[i].username %></td>
		<td><button id="rp<%= accounts[i].id %>">reset password</button></td>
		<td><a id="link" href="#confirm<%=accounts[i].id%>" role="button" class="btn" data-toggle="modal">delete</a></td>
	</tr>
<% } %>
<tr><td colspan="3"><a href="/addAccount">Add new account</a></td></tr>
</table>



<% for(var i=0; i<accounts.length; i++) {%>
  <!-- Modal -->
  <div id="confirm<%=accounts[i].id%>" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
          <h4 class="modal-title">Modal title</h4>
        </div>
        <div class="modal-body">
          ...
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
  </div><!-- /.modal -->
<% } %>

<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/>
<div id="goHere">MEHEHEHEHEHEH!</div>


<script>

<%for(var i=0; i<accounts.length; i++){%>
            
            $("#rp<%=accounts[i].id%>").click(function() {   
                       
              $.ajax({
                   url: '/resetPass',
                   type: 'POST',
                   data: {id:'<%=accounts[i].id%>'},
                   success: function(response){
            			if(!response)
                        	$('#errorMsg').replaceWith("An error has occured <br/>"); 
                   		else
                        	$('#errorMsg').replaceWith("Update Successful!"); 
                   }
   

              });
            });    
  
    
            $("#d<%=accounts[i].id%>").click(function() {   
                       
              $.ajax({
                   url: '/deleteAccount',
                   type: 'POST',
                   data: {id:'<%=accounts[i].id%>'},
                   success: function(response){
            		if(!response)
                        $('#errorMsg').replaceWith("An error has occured <br/>"); 
                     else
                       $('#row<%=accounts[i].id%>').replaceWith(""); 
                   }
  

              });
            });  
 
<% } %>




  



</script>
